@model TarefaViewModel

@{
    ViewData["Title"] = "Index";
}

<div class="container">
    <div class="offset-md-1 col-md-10">
        <div id="feedBack">
        </div>
        <div class="card tarefas">            
            <div class="card-header">
                <h4 class="card-title">Adicionar Tarefa</h4>
            </div>
            <div class="card-body">
                <div class="offset-md-1 col-md-10">
                    <div class="row">
                        <form asp-action="CriarTarefa">
                            <div id="formularioTarefa">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Título</label>
                                            <input type="text" id="Titulo" class="form-control" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Data de entrega</label>
                                            <input type="text" id="DtTarefaFim" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Descrição da tarefa</label>
                                        <textarea id="Descricao" class="form-control"></textarea>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end" style="margin-top: 10px;">
                                    <div class="form-group" style="margin-top: 10px;">
                                        <button id="btn-salvar" type="button" class="btn btn-tela" onclick="AjaxRegistrarTarefas()">Salvar</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="card tarefas">
            <div class="card-header">
                <h4 class="card-title">Lista de Tarefas</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-tela" onclick="AjaxFinalizarTarefaEmMassa()">Finalizar Selecionadas</button>
                    </div>
                </div>
                <div class="row border-bottom" style="margin-top:10px;">
                    <div class="col-1">
                        <input type="checkbox" id="finalizar-todos" onclick="ativarTodos()">
                    </div>
                    <div class="col-3">Tarefa</div>
                    <div class="col-4">Descrição</div>
                    <div class="col-2">Data Finalização</div>
                    <div class="col-2"></div>
                </div>

                @foreach (var item in Model.Tarefas)
                {
                    <div class="row border-bottom" style="margin-top:10px;">
                        <div class="col-1">
                            <input type="hidden" value="@item.Id">
                            <input type="checkbox" id="finalizar-@item.Id">
                        </div>
                        <div class="col-3">
                            @Html.DisplayFor(modelItem => item.Titulo)
                        </div>
                        <div class="col-4">
                            @Html.DisplayFor(modelItem => item.Descricao)
                        </div>
                        <div class="col-2">
                            @item.DtTarefaFim.ToString("dd/MM/yyyy")
                        </div>
                        <div class="col-2">
                            <button type="button" class="btn btn-tela" onclick="AjaxFinalizarTarefa(@item.Id)">Finalizar</button>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="~/css/listaTarefas.css" />
<link rel="stylesheet" href="~/lib/jquery-ui/css/jquery-ui.min.css" />

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script src="~/lib/jquery-ui/jquery-ui.min.js"></script>
    <script src="~/js/site.js"></script>
    <script src="~/js/Tarefa/script.js"></script>
    <script>
        $(document).keypress(function(e) {
            if (e.which === 13) {
                $('#btn-salvar').click();
            }
        });
    </script>
}
